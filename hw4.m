%% problem 3
%% Setting the necessary parameters
x0 = 1;
xn = 3;
n1 = 4;
n2 = 50;
d1 = (3-1)/n1;
d2 = (3-1)/n2;
xinterval1 = x0:d1:xn;
xinterval2 = x0:d2:xn;
%% for f(1) = 5, f(3) = -1, n = 4
L = [1,0,0,0,0;1,-2,1,0,0;0,1,-2,1,0;0,0,1,-2,1;0,0,0,0,1];
b = [5,0,0,0,-1]';
Q = [0,0,0,0,0;0,1.5,0,0,0;0,0,2,0,0;0,0,0,2.5,0;0,0,0,0,0];
A = (L + (d1^2)*Q);
%% for f(1) = 5, f(3) = -1, n = 50
L1 = diag(-2*ones(1,n2+1)) + diag(ones(1,n2),1) + diag(ones(1,n2),-1);
L1(1,1) = 1; L1(1,2) = 0; L1(n2+1,n2+1) = 1; L1(n2+1,n2) = 0;
Q1 = diag(xinterval2);
Q1(1,1) = 0; Q1(n2+1, n2+1) = 0;
b1 = zeros(n2+1,1); b1(1) = 5; b1(n2+1) = -1;
A1 = (L1 + (d2^2)*Q1);
F1 = A1\b1;
%% for f(1) = 5, f'(3) = -1, n = 4
L2 = [1,0,0,0,0;1,-2,1,0,0;0,1,-2,1,0;0,0,1,-2,1;0,0,0,-1,1];
b2 = [5,0,0,0,-0.5]';
A2 = (L2 + (d1^2)*Q);
%% for f(1) = 5, f'(3) = -1, n = 50
L3 = diag(-2*ones(1,n2+1)) + diag(ones(1,n2),1) + diag(ones(1,n2),-1);
L3(1,1) = 1; L3(1,2) = 0; L3(n2+1,n2+1) = 1; L3(n2+1,n2) = -1;
b3 = zeros(n2+1,1); b3(1) = 5; b3(n2+1) = -1*d2;
A3 = (L3 + (d2^2)*Q1);
F3 = A3\b3;
%% plotting the graph
plot(xinterval2, F3, xinterval2, F1)